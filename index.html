<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BG РЕСТО: Калкулатор за € и лв (ТЕСТ)</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* CSS СТИЛОВЕ */
        body { 
            font-family: 'Roboto', sans-serif; 
            background-color: #f4f7f6; 
            color: #333; 
            margin: 0; 
            padding: 0; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            min-height: 100vh;
        }
        .container { 
            width: 95%; 
            max-width: 400px; 
            padding: 20px; 
            background-color: #fff; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); 
            border-radius: 12px; 
            margin-top: 20px; 
            margin-bottom: 20px;
        }
        h1 { 
            color: #007bff; 
            text-align: center; 
            margin-bottom: 20px; 
            font-size: 1.5em; 
            border-bottom: 2px solid #007bff; 
            padding-bottom: 10px;
        }
        .locked-content, #result { 
            display: block; /* Променено на block за отключване */
        } 
        /* Скриваме секцията за отключване, тъй като е тестово */
        #unlock-section {
            display: none; 
        }
        .form-group { 
            margin-bottom: 15px; 
        }
        label { 
            display: block; 
            margin-bottom: 5px; 
            font-weight: 700; 
            color: #555; 
        }
        input[type="number"], input[type="text"], button { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #ccc; 
            border-radius: 8px; 
            box-sizing: border-box; 
            font-size: 1em; 
        }
        button { 
            background-color: #007bff; 
            color: white; 
            border: none; 
            cursor: pointer; 
            transition: background-color 0.3s; 
            font-weight: 700; 
            margin-top: 10px; 
        }
        button:hover { 
            background-color: #0056b3; 
        }
        .result-box { 
            margin-top: 25px; 
            padding: 15px; 
            border-radius: 8px; 
            background-color: #e8f5e9; 
            border-left: 5px solid #4caf50; 
        }
        .result-box div { 
            margin-bottom: 10px; 
            font-size: 1.1em; 
            font-weight: 700; 
        }
        .result-box span { 
            color: #4caf50; 
        }
        /* Стил за червен код, въпреки че секцията е скрита в този режим */
        #error-message {
            color: red;
            font-weight: 700;
            margin-top: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>BG РЕСТО: Калкулатор за € и лв (ТЕСТОВ РЕЖИМ)</h1>

        <div id="unlock-section">
            <p>Приложението е временно отключено за тестване.</p>
            <p id="error-message"></p>
        </div>

        <div id="locked-content" class="locked-content">
            <div class="form-group">
                <label for="billEur">Сметка в Евро (€):</label>
                <input type="number" id="billEur" value="0.00" step="0.01">
            </div>
            <div class="form-group">
                <label for="billBgn">Сметка в Лева (лв):</label>
                <input type="number" id="billBgn" value="0.00" step="0.01">
            </div>
            <hr>
            <div class="form-group">
                <label for="paidEur">Платено в Евро (€):</label>
                <input type="number" id="paidEur" value="0.00" step="0.01">
            </div>
            <div class="form-group">
                <label for="paidBgn">Платено в Лева (лв):</label>
                <input type="number" id="paidBgn" value="0.00" step="0.01">
            </div>
            
            <button onclick="calculateChange()">ИЗЧИСЛИ РЕСТО</button>

            <div id="result" class="result-box">
                <div>Връщаш Евро (€): <span id="resEur">0.00</span></div>
                <div>Връщаш Лева (лв): <span id="resBgn">0.00</span></div>
            </div>
        </div>
    </div>

    <script>
        const EXCHANGE_RATE = 1.95583;

        // Тази функция е запазена, но вече не се извиква за заключване/отключване
        function calculateChange() {
            const billEur = parseFloat(document.getElementById('billEur').value) || 0;
            const billBgn = parseFloat(document.getElementById('billBgn').value) || 0;
            const paidEur = parseFloat(document.getElementById('paidEur').value) || 0;
            const paidBgn = parseFloat(document.getElementById('paidBgn').value) || 0;

            // 1. Конвертиране на всичко към ЛЕВА за общата сметка и платената сума
            const totalBillBgn = billBgn + (billEur * EXCHANGE_RATE);
            const totalPaidBgn = paidBgn + (paidEur * EXCHANGE_RATE);

            // 2. Изчисление на общото ресто (в Лева)
            let totalChangeBgn = totalPaidBgn - totalBillBgn;

            if (totalChangeBgn < 0) {
                document.getElementById('resEur').textContent = "---";
                document.getElementById('resBgn').textContent = "Недостатъчна сума!";
                document.getElementById('result').style.backgroundColor = '#fce4e4'; 
                document.getElementById('result').style.borderLeft = '5px solid #f44336';
                document.getElementById('result').style.display = 'block';
                return;
            }

            // 3. Разделяне на рестото обратно на Евро и Лева
            
            // Връщаме максималното възможно ресто в Евро (цяло число евро)
            let changeEur = Math.floor(totalChangeBgn / EXCHANGE_RATE);
            
            // Остатъкът, който трябва да върнем в Лева
            let changeBgn = totalChangeBgn - (changeEur * EXCHANGE_RATE);
            
            // Закръгляме левовете до втората цифра след десетичната запетая
            changeBgn = Math.round(changeBgn * 100) / 100;
            
            // Корекция, ако закръгляването доведе до излишък от 1.95583+ лв.
            if (changeBgn >= EXCHANGE_RATE) {
                changeEur += Math.floor(changeBgn / EXCHANGE_RATE);
                changeBgn = changeBgn % EXCHANGE_RATE;
                changeBgn = Math.round(changeBgn * 100) / 100;
            }

            // 4. Показване на резултата
            document.getElementById('resEur').textContent = changeEur.toFixed(2);
            document.getElementById('resBgn').textContent = changeBgn.toFixed(2);
            document.getElementById('result').style.backgroundColor = '#e8f5e9'; 
            document.getElementById('result').style.borderLeft = '5px solid #4caf50';
            document.getElementById('result').style.display = 'block';
        }
    </script>
</body>
</html>